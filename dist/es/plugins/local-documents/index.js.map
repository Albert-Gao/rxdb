{"version":3,"sources":["../../../../src/plugins/local-documents/index.ts"],"names":["getLocal","getLocal$","insertLocal","upsertLocal","closeStateByParent","createLocalDocStateByParent","removeLocalDocumentsStorageInstance","RxDBLocalDocumentsPlugin","name","rxdb","prototypes","RxCollection","proto","RxDatabase","hooks","createRxDatabase","before","args","creator","localDocuments","database","createRxCollection","collection","preDestroyRxDatabase","after","db","postDestroyRxCollection","postRemoveRxDatabase","storage","databaseName","postRemoveRxCollection","collectionName","overwritable"],"mappings":"AAGA,SACIA,QADJ,EAEIC,SAFJ,EAGIC,WAHJ,EAIIC,WAJJ,QAKO,mBALP;AAMA,SACIC,kBADJ,EAEIC,2BAFJ,EAGIC,mCAHJ,QAIO,0BAJP;AAMA,cAAc,mBAAd;AACA,cAAc,qBAAd;AASA,OAAO,IAAMC,wBAAkC,GAAG;AAC9CC,EAAAA,IAAI,EAAE,iBADwC;AAE9CC,EAAAA,IAAI,EAAE,IAFwC;AAG9CC,EAAAA,UAAU,EAAE;AACRC,IAAAA,YAAY,EAAE,sBAACC,KAAD,EAAgB;AAC1BA,MAAAA,KAAK,CAACV,WAAN,GAAoBA,WAApB;AACAU,MAAAA,KAAK,CAACT,WAAN,GAAoBA,WAApB;AACAS,MAAAA,KAAK,CAACZ,QAAN,GAAiBA,QAAjB;AACAY,MAAAA,KAAK,CAACX,SAAN,GAAkBA,SAAlB;AACH,KANO;AAORY,IAAAA,UAAU,EAAE,oBAACD,KAAD,EAAgB;AACxBA,MAAAA,KAAK,CAACV,WAAN,GAAoBA,WAApB;AACAU,MAAAA,KAAK,CAACT,WAAN,GAAoBA,WAApB;AACAS,MAAAA,KAAK,CAACZ,QAAN,GAAiBA,QAAjB;AACAY,MAAAA,KAAK,CAACX,SAAN,GAAkBA,SAAlB;AACH;AAZO,GAHkC;AAiB9Ca,EAAAA,KAAK,EAAE;AACHC,IAAAA,gBAAgB,EAAE;AACdC,MAAAA,MAAM,EAAE,gBAAAC,IAAI,EAAI;AACZ,YAAIA,IAAI,CAACC,OAAL,CAAaC,cAAjB,EAAiC;AAC7B;AACpB;AACA;AACA;;AACoB;AAAYd,UAAAA,2BAA2B,CAACY,IAAI,CAACG,QAAN,CAA3B;AACf;AACJ;AATa,KADf;AAYHC,IAAAA,kBAAkB,EAAE;AAChBL,MAAAA,MAAM,EAAE,gBAAAC,IAAI,EAAI;AACZ,YAAIA,IAAI,CAACC,OAAL,CAAaC,cAAjB,EAAiC;AAC7B;AACpB;AACA;AACA;;AACoB;AAAYd,UAAAA,2BAA2B,CAACY,IAAI,CAACK,UAAN,CAA3B;AACf;AACJ;AATe,KAZjB;AAuBHC,IAAAA,oBAAoB,EAAE;AAClBC,MAAAA,KAAK,EAAE,eAAAC,EAAE,EAAI;AACT,eAAOrB,kBAAkB,CAACqB,EAAD,CAAzB;AACH;AAHiB,KAvBnB;AA4BHC,IAAAA,uBAAuB,EAAE;AACrBF,MAAAA,KAAK,EAAE,eAAAF,UAAU;AAAA,eAAIlB,kBAAkB,CAACkB,UAAD,CAAtB;AAAA;AADI,KA5BtB;AA+BHK,IAAAA,oBAAoB,EAAE;AAClBH,MAAAA,KAAK,EAAE,eAAAP,IAAI,EAAI;AACX,eAAOX,mCAAmC,CACtCW,IAAI,CAACW,OADiC,EAEtCX,IAAI,CAACY,YAFiC,EAGtC,EAHsC,CAA1C;AAKH;AAPiB,KA/BnB;AAwCHC,IAAAA,sBAAsB,EAAE;AACpBN,MAAAA,KAAK,EAAE,eAAAP,IAAI,EAAI;AACX,eAAOX,mCAAmC,CACtCW,IAAI,CAACW,OADiC,EAEtCX,IAAI,CAACY,YAFiC,EAGtCZ,IAAI,CAACc,cAHiC,CAA1C;AAKH;AAPmB;AAxCrB,GAjBuC;AAmE9CC,EAAAA,YAAY,EAAE;AAnEgC,CAA3C","sourcesContent":["import type {\n    RxPlugin\n} from '../../types';\nimport {\n    getLocal,\n    getLocal$,\n    insertLocal,\n    upsertLocal\n} from './local-documents';\nimport {\n    closeStateByParent,\n    createLocalDocStateByParent,\n    removeLocalDocumentsStorageInstance\n} from './local-documents-helper';\n\nexport * from './local-documents';\nexport * from './rx-local-document';\nexport type {\n    LocalDocumentParent,\n    LocalDocumentState,\n    RxLocalDocument,\n    RxLocalDocumentData\n} from '../../types/plugins/local-documents';\n\n\nexport const RxDBLocalDocumentsPlugin: RxPlugin = {\n    name: 'local-documents',\n    rxdb: true,\n    prototypes: {\n        RxCollection: (proto: any) => {\n            proto.insertLocal = insertLocal;\n            proto.upsertLocal = upsertLocal;\n            proto.getLocal = getLocal;\n            proto.getLocal$ = getLocal$;\n        },\n        RxDatabase: (proto: any) => {\n            proto.insertLocal = insertLocal;\n            proto.upsertLocal = upsertLocal;\n            proto.getLocal = getLocal;\n            proto.getLocal$ = getLocal$;\n        }\n    },\n    hooks: {\n        createRxDatabase: {\n            before: args => {\n                if (args.creator.localDocuments) {\n                    /**\n                     * We do not have to await\n                     * the creation to speed up initial page load.\n                     */\n                    /* await */ createLocalDocStateByParent(args.database);\n                }\n            }\n        },\n        createRxCollection: {\n            before: args => {\n                if (args.creator.localDocuments) {\n                    /**\n                     * We do not have to await\n                     * the creation to speed up initial page load.\n                     */\n                    /* await */ createLocalDocStateByParent(args.collection);\n                }\n            }\n        },\n        preDestroyRxDatabase: {\n            after: db => {\n                return closeStateByParent(db);\n            }\n        },\n        postDestroyRxCollection: {\n            after: collection => closeStateByParent(collection)\n        },\n        postRemoveRxDatabase: {\n            after: args => {\n                return removeLocalDocumentsStorageInstance(\n                    args.storage,\n                    args.databaseName,\n                    ''\n                );\n            }\n        },\n        postRemoveRxCollection: {\n            after: args => {\n                return removeLocalDocumentsStorageInstance(\n                    args.storage,\n                    args.databaseName,\n                    args.collectionName\n                );\n            }\n        }\n    },\n    overwritable: {}\n};\n"],"file":"index.js"}